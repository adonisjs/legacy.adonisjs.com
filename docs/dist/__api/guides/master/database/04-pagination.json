{"type":"root","children":[{"type":"element","tag":"dimertitle","props":{},"children":[{"type":"text","value":"Pagination"}]},{"type":"element","tag":"h1","props":{"id":"pagination"},"children":[{"type":"element","tag":"a","props":{"href":"#pagination","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Pagination"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lucid has inbuilt support for "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"offset based pagination"}]},{"type":"text","value":" using the Database query builder and Models both. By the end of this guide, you will know:"}]},{"type":"element","tag":"div","props":{"className":["toc-container"]},"children":[{"type":"element","tag":"h2","props":{},"children":[{"type":"text","value":"Table of contents"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#paginating-records"},"children":[{"type":"text","value":"Paginating Records"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#displaying-pagination-links"},"children":[{"type":"text","value":"Displaying pagination links"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#serializing-to-json"},"children":[{"type":"text","value":"Serializing to JSON"}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How to paginate records using the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"page"}]},{"type":"text","value":" and the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"limit"}]},{"type":"text","value":" parameters."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How to create pagination links inside your views."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How to serialize pagination output for an API response."}]}]},{"type":"element","tag":"h2","props":{"id":"paginating-records"},"children":[{"type":"element","tag":"a","props":{"href":"#paginating-records","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Paginating Records"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The database and model query builders comes with the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"paginate"}]},{"type":"text","value":" method to allow offset based pagination. For example:"}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'page'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> limit <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n\n<span class=\"token keyword\">const</span> posts <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Post<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">paginate</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">,</span> limit<span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>posts<span class=\"token punctuation\">)</span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Following is the output of the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"paginate"}]},{"type":"text","value":" method."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"SimplePaginator <span class=\"token punctuation\">{</span>\n  rows<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    Post <span class=\"token punctuation\">{</span>\n     <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    Post <span class=\"token punctuation\">{</span>\n     <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  totalNumber<span class=\"token operator\">:</span> <span class=\"token string\">'50'</span><span class=\"token punctuation\">,</span>\n  perPage<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n  currentPage<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  qs<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  url<span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n  firstPage<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  isEmpty<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  total<span class=\"token operator\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\n  hasTotal<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  lastPage<span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\n  hasMorePages<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  hasPages<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"paginate"}]},{"type":"text","value":" method accepts a total of two arguments. The "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"page"}]},{"type":"text","value":" number and the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"limit"}]},{"type":"text","value":" of records to fetch."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Internally, we execute an additional count query to count the number of total rows."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The output of the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"paginate"}]},{"type":"text","value":" method is an instance of the "},{"type":"element","tag":"a","props":{"href":"https://github.com/adonisjs/lucid/blob/9876fdad6e7cdec70c6bad9edb6c4dc4bd5c7afd/src/Database/Paginator/SimplePaginator.ts"},"children":[{"type":"text","value":"SimplePaginator"}]},{"type":"text","value":" class."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"rows"}]},{"type":"text","value":" property contains an array of rows fetched from the database."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The other properties like "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"total"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"hasMorePages"}]},{"type":"text","value":" is the pagination meta data."}]}]},{"type":"element","tag":"h2","props":{"id":"displaying-pagination-links"},"children":[{"type":"element","tag":"a","props":{"href":"#displaying-pagination-links","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Displaying pagination links"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this section, we will use the pagination meta data to render the pagination links as anchor tags. The first step is to render the view and pass the posts collection to it."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> HttpContextContract <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@ioc:Adonis/Core/HttpContext'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">PostsController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token function\">index</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> request<span class=\"token punctuation\">,</span> view <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> HttpContextContract<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'page'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> limit <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n\n    <span class=\"token keyword\">const</span> posts <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Post<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">paginate</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">,</span> limit<span class=\"token punctuation\">)</span>\n<span class=\"dimer-highlight-code-line\">    <span class=\"token keyword\">return</span> view<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">'posts/index'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> posts <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Next open "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"posts/index.edge"}]},{"type":"text","value":" file and paste the following code snippet inside it."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-edge","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token other\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span></span>\n<span class=\"token tag\"><span class=\"token function\">  @each</span>(post <span class=\"token keyword\">in </span>posts.rows)</span>\n    <span class=\"token other\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span></span><span class=\"token mustache\"><span class=\"token punctuation\">{{</span> post.title <span class=\"token punctuation\">}}</span></span><span class=\"token other\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span></span> <span class=\"token mustache\"><span class=\"token punctuation\">{{</span> excerpt(post.body, <span class=\"token number\">200</span>) <span class=\"token punctuation\">}}</span></span> <span class=\"token other\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></span>\n<span class=\"token tag\"><span class=\"token function\">  @endeach</span></span>\n<span class=\"token other\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"dimer-highlight-code-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span></span></span><span class=\"dimer-highlight-code-line\"><span class=\"token tag\"><span class=\"token function\">  @each</span>(anchor <span class=\"token keyword\">in </span>posts.getUrlsForRange(<span class=\"token number\">1</span>, posts.lastPage))</span></span><span class=\"dimer-highlight-code-line\">    <span class=\"token other\">&lt;a href=\"</span><span class=\"token mustache\"><span class=\"token punctuation\">{{</span> anchor.url <span class=\"token punctuation\">}}</span></span><span class=\"token other\">\"></span></span><span class=\"dimer-highlight-code-line\">      <span class=\"token mustache\"><span class=\"token punctuation\">{{</span> anchor.page <span class=\"token punctuation\">}}</span></span></span><span class=\"dimer-highlight-code-line\">    <span class=\"token other\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></span></span><span class=\"dimer-highlight-code-line\"><span class=\"token tag\"><span class=\"token function\">  @endeach</span></span></span><span class=\"dimer-highlight-code-line\"><span class=\"token other\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></span>"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"getUrlsForRange"}]},{"type":"text","value":" method returns an array of objects with following properties."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    url<span class=\"token operator\">:</span> <span class=\"token string\">'/?page=1'</span><span class=\"token punctuation\">,</span>\n    page<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    isActive<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    isSeperator<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    url<span class=\"token operator\">:</span> <span class=\"token string\">'/?page=2'</span><span class=\"token punctuation\">,</span>\n    page<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    isActive<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    isSeperator<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">]</span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you notice carefully, the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"url"}]},{"type":"text","value":" property uses the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"/"}]},{"type":"text","value":" route. You can change this inside the controller before rendering the view, as shown in the following example."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token keyword\">const</span> posts <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Post<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">paginate</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">,</span> limit<span class=\"token punctuation\">)</span>\n<span class=\"dimer-highlight-code-line\">posts<span class=\"token punctuation\">.</span><span class=\"token function\">baseUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/posts'</span><span class=\"token punctuation\">)</span></span>\n<span class=\"token keyword\">return</span> view<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">'posts/index'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> posts <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finally, you must see the pagination links appear as shown in the following screenshot."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"src":"https://res.cloudinary.com/adonis-js/image/upload/v1596970976/adonisjs.com/lucid-pagination.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"serializing-to-json"},"children":[{"type":"element","tag":"a","props":{"href":"#serializing-to-json","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Serializing to JSON"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Serializing SimplePaginator instance to JSON is straight forward. Just call the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":".toJSON"}]},{"type":"text","value":" method and you will get JSON object as shown below:"}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-json","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"meta\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"total\"</span><span class=\"token operator\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"per_page\"</span><span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"current_page\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"last_page\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"first_page\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"first_page_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/?page=1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"last_page_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/?page=10\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"next_page_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/?page=2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"previous_page_url\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"data\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]}]}
