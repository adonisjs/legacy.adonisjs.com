{"type":"root","children":[{"type":"element","tag":"dimertitle","props":{},"children":[{"type":"text","value":"BelongsTo"}]},{"type":"element","tag":"h1","props":{"id":"belongsto"},"children":[{"type":"element","tag":"a","props":{"href":"#belongsto","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"BelongsTo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"BelongsTo"}]},{"type":"text","value":" relationship creates a "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"one-to-one"}]},{"type":"text","value":" relationship between two models. It is always the inverse of "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"HasOne"}]},{"type":"text","value":" or "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"HasMany"}]},{"type":"text","value":"."}]},{"type":"element","tag":"div","props":{"className":["toc-container"]},"children":[{"type":"element","tag":"h2","props":{},"children":[{"type":"text","value":"Table of contents"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#relationship-models"},"children":[{"type":"text","value":"Relationship models"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#custom-foreign-key"},"children":[{"type":"text","value":"Custom foreign key"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#custom-local-key"},"children":[{"type":"text","value":"Custom local key"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#table-structure"},"children":[{"type":"text","value":"Table structure"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#preloading-relationship"},"children":[{"type":"text","value":"Preloading relationship"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#persisting-relationship"},"children":[{"type":"text","value":"Persisting relationship"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#associate"},"children":[{"type":"text","value":"associate"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#dissociate"},"children":[{"type":"text","value":"dissociate"}]}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If the foreign key exists on the parent model, then it will always belong to a related model. For example: The "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"userId"}]},{"type":"text","value":" exists on the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"Profile"}]},{"type":"text","value":" model, so it will have a belongs to relationship with the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"User"}]},{"type":"text","value":" model."}]},{"type":"element","tag":"h2","props":{"id":"relationship-models"},"children":[{"type":"element","tag":"a","props":{"href":"#relationship-models","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Relationship models"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Continuing with the profile and the user example. Following is the Profile model with "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"belongsTo"}]},{"type":"text","value":" relationship."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"app/Models/Profile.ts"}]},{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> column<span class=\"token punctuation\">,</span> BaseModel<span class=\"token punctuation\">,</span> belongsTo<span class=\"token punctuation\">,</span> BelongsTo <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@ioc:Adonis/Lucid/Orm'</span>\n<span class=\"token keyword\">import</span> User <span class=\"token keyword\">from</span> <span class=\"token string\">'App/Models/User'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Profile</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseModel</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Foreign key</span>\n  @<span class=\"token function\">column</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> userId<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n\n<span class=\"dimer-highlight-code-line\">  @<span class=\"token function\">belongsTo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> User<span class=\"token punctuation\">)</span></span><span class=\"dimer-highlight-code-line\">  <span class=\"token keyword\">public</span> user<span class=\"token operator\">:</span> BelongsTo<span class=\"token operator\">&lt;</span><span class=\"token keyword\">typeof</span> User<span class=\"token operator\">></span></span><span class=\"token punctuation\">}</span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The User model just needs the local key (primary key in most cases)."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"app/Models/User.ts"}]},{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> column<span class=\"token punctuation\">,</span> BaseModel <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@ioc:Adonis/Lucid/Orm'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseModel</span> <span class=\"token punctuation\">{</span>\n  @<span class=\"token function\">column</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> isPrimary<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> id<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"custom-foreign-key"},"children":[{"type":"element","tag":"a","props":{"href":"#custom-foreign-key","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Custom foreign key"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By default, the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"foreignKey"}]},{"type":"text","value":" is the camelCase representation of the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"related model name"}]},{"type":"text","value":" and its primary key."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Related Model Name"}]},{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Primary Key"}]},{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Foreign Key"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"User"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"id"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"userId"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"However, you can also define a custom foreign key."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"@<span class=\"token function\">belongsTo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> User<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  foreignKey<span class=\"token operator\">:</span> <span class=\"token string\">'profileUserId'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> user<span class=\"token operator\">:</span> BelongsTo<span class=\"token operator\">&lt;</span><span class=\"token keyword\">typeof</span> User<span class=\"token operator\">></span>\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"custom-local-key"},"children":[{"type":"element","tag":"a","props":{"href":"#custom-local-key","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Custom local key"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The local key is always the primary key of the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"related model"}]},{"type":"text","value":", but can be defined explicitly."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"@<span class=\"token function\">belongsTo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> User<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  localKey<span class=\"token operator\">:</span> <span class=\"token string\">'uuid'</span><span class=\"token punctuation\">,</span>\n  foreignKey<span class=\"token operator\">:</span> <span class=\"token string\">'profileUserId'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> user<span class=\"token operator\">:</span> BelongsTo<span class=\"token operator\">&lt;</span><span class=\"token keyword\">typeof</span> User<span class=\"token operator\">></span>\n"}]}]}]},{"type":"element","tag":"h2","props":{"id":"table-structure"},"children":[{"type":"element","tag":"a","props":{"href":"#table-structure","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Table structure"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Following is an example table describing the relationship at the database level."}]},{"type":"element","tag":"div","props":{"className":["alert","alert-note"]},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lucid models doesn't rely on the database level foreign key constraint. It just needs the columns to be present and must be of same data types."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"src":"https://res.cloudinary.com/adonis-js/image/upload/q_auto,w_700,f_auto,fl_lossy/v1588083599/adonisjs.com/belongs-to.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"preloading-relationship"},"children":[{"type":"element","tag":"a","props":{"href":"#preloading-relationship","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Preloading relationship"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The preloading API for a belongs to relationship is already covered in the "},{"type":"element","tag":"a","props":{"href":"/guides/model-relations/introduction#preloading-relationship"},"children":[{"type":"text","value":"introduction guide"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"persisting-relationship"},"children":[{"type":"element","tag":"a","props":{"href":"#persisting-relationship","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Persisting relationship"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When working with a belongs to relationship, you are always associating or dissociating models with each other. For example: You never say, "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"create a user for this profile"}]},{"type":"text","value":". Instead, you say, "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"link profile to this user"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the true spirit of readability, a "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"belongsTo"}]},{"type":"text","value":" relationship does not have "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"create"}]},{"type":"text","value":" or "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"save"}]},{"type":"text","value":" methods. It has "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"associate"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"dissociate"}]},{"type":"text","value":" methods."}]},{"type":"element","tag":"h3","props":{"id":"associate"},"children":[{"type":"element","tag":"a","props":{"href":"#associate","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"associate"}]}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> User<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> profile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Profile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nprofile<span class=\"token punctuation\">.</span>avatarUrl <span class=\"token operator\">=</span> <span class=\"token string\">'foo.jpg'</span>\nprofile<span class=\"token punctuation\">.</span>isActive <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n\n<span class=\"token comment\">// Save profile with the user id of the user</span>\n<span class=\"token keyword\">await</span> profile<span class=\"token punctuation\">.</span><span class=\"token function\">related</span><span class=\"token punctuation\">(</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">associate</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span>\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"dissociate"},"children":[{"type":"element","tag":"a","props":{"href":"#dissociate","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"dissociate"}]}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token keyword\">const</span> profile <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Profile<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">await</span> profile<span class=\"token punctuation\">.</span><span class=\"token function\">related</span><span class=\"token punctuation\">(</span><span class=\"token string\">'user'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">dissociate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n"}]}]}]}]}
