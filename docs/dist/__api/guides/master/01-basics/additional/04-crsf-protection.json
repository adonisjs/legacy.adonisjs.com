{"type":"root","children":[{"type":"element","tag":"dimertitle","props":{},"children":[{"type":"text","value":"CSRF Protection"}]},{"type":"element","tag":"h1","props":{"id":"csrf-protection"},"children":[{"type":"element","tag":"a","props":{"href":"#csrf-protection","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"CSRF Protection"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Keeping the security at the forefront, AdonisJS comes with all the tooling required to keep your applications secure from common Web attacks like "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"CSRF"}]},{"type":"text","value":", "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"XSS"}]},{"type":"text","value":", "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"CSP"}]},{"type":"text","value":" and lot more."}]},{"type":"element","tag":"div","props":{"className":["toc-container"]},"children":[{"type":"element","tag":"h2","props":{},"children":[{"type":"text","value":"Table of contents"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#what-is-a-csrf-attack"},"children":[{"type":"text","value":"What is a CSRF attack?"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#setup"},"children":[{"type":"text","value":"Setup"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#secure-by-default"},"children":[{"type":"text","value":"Secure by default"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#fixing-the-error"},"children":[{"type":"text","value":"Fixing the error"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#how-it-works"},"children":[{"type":"text","value":"How it works?"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#configuration"},"children":[{"type":"text","value":"Configuration"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#enabled"},"children":[{"type":"text","value":"enabled"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#exceptroutes"},"children":[{"type":"text","value":"exceptRoutes"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#methods"},"children":[{"type":"text","value":"methods"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#enablexsrfcookie"},"children":[{"type":"text","value":"enableXsrfCookie"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#csrf-token-for-spa"},"children":[{"type":"text","value":"CSRF token for SPA"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#csrf-token-for-restful-api"},"children":[{"type":"text","value":"CSRF token for RESTful API"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this guide, we will just focus on the CSRF protection."}]},{"type":"element","tag":"h2","props":{"id":"what-is-a-csrf-attack"},"children":[{"type":"element","tag":"a","props":{"href":"#what-is-a-csrf-attack","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"What is a CSRF attack?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CSRF (Cross Site Request Forgery) is an attack, in which a 3rd party website can trick the users of your website to submit forms without their explicit consent."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For an in-depth understanding of the attack, we recommend you reading "},{"type":"element","tag":"a","props":{"href":"https://owasp.org/www-community/attacks/csrf"},"children":[{"type":"text","value":"this article"}]},{"type":"text","value":". But for now, we will focus on the AdonisJS side of things to prevent this attack from happening."}]},{"type":"element","tag":"h2","props":{"id":"setup"},"children":[{"type":"element","tag":"a","props":{"href":"#setup","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Setup"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The CSRF protection, along with many other guards are part of the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"@adonisjs/shield"}]},{"type":"text","value":" package. So let's get it configured first."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Run the following command to install the package from the npm registry."}]},{"type":"element","tag":"div","props":{"className":["tabs"]},"children":[{"type":"element","tag":"div","props":{"className":["tab-head"]},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{"dataTitle":"tab-1"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"li","props":{"dataTitle":"tab-2"},"children":[{"type":"text","value":"yarn"}]}]}]},{"type":"element","tag":"div","props":{"className":["tab-body"]},"children":[{"type":"element","tag":"div","props":{"className":["tab-item"],"id":"tab-1"},"children":[{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"pre","props":{"className":["language-sh","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token function\">npm</span> i @adonisjs/shield@alpha\n"}]}]}]}]},{"type":"element","tag":"div","props":{"className":["tab-item"],"id":"tab-2"},"children":[{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"yarn"}]},{"type":"element","tag":"pre","props":{"className":["language-sh","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token function\">yarn</span> <span class=\"token function\">add</span> @adonisjs/shield@alpha\n"}]}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Run the following command to configure the package."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-sh","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"node ace invoke @adonisjs/shield\n\n<span class=\"token comment\"># ✔  create    config/shield.ts</span>\n<span class=\"token comment\">#    update    .adonisrc.json</span>\n<span class=\"token comment\"># ✔  create    ace-manifest.json</span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finally, register the following middleware inside "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"start/kernel.ts"}]},{"type":"text","value":" file. The middleware must be right after "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"BodyParserMiddleware"}]},{"type":"text","value":"."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"start/kernel.ts"}]},{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"],"dataLine":"3"},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"Server<span class=\"token punctuation\">.</span>middleware<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token string\">'Adonis/Core/BodyParserMiddleware'</span><span class=\"token punctuation\">,</span>\n<span class=\"dimer-highlight-code-line\">  <span class=\"token string\">'Adonis/Addons/ShieldMiddleware'</span><span class=\"token punctuation\">,</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n"}]}]}]},{"type":"element","tag":"h2","props":{"id":"secure-by-default"},"children":[{"type":"element","tag":"a","props":{"href":"#secure-by-default","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Secure by default"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As soon as the package is configured, all of the HTML forms will be protected against CSRF attacks. For demonstration, lets create a new form and try submitting it without the CSRF token."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Define the following routes"}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"start/routes.ts"}]},{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"Route<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'posts/create'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">'posts/create'</span><span class=\"token punctuation\">)</span>\nRoute<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'posts'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PostsController.store'</span><span class=\"token punctuation\">)</span>\n"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Render the HTML form"}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"resources/views/posts/create.edge"}]},{"type":"element","tag":"pre","props":{"className":["language-edge","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token other\">&lt;form action=\"</span><span class=\"token mustache\"><span class=\"token punctuation\">{{</span> route(<span class=\"token string\"><span class=\"token punctuation\">'</span><span class=\"token other\">PostsController.store</span><span class=\"token punctuation\">'</span></span>) <span class=\"token punctuation\">}}</span></span><span class=\"token other\">\" method=\"post\">\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Post title<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Create Post<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span></span>\n"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finally, define the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"PostsController.store"}]},{"type":"text","value":" to handle the form submission"}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"app/Controllers/Http/PostsController.ts"}]},{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PostsController</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token function\">store</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">'Form submission handled'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now, if you visit "},{"type":"element","tag":"a","props":{"href":"http://localhost:3333/posts/create"},"children":[{"type":"text","value":"http://localhost:3333/posts/create"}]},{"type":"text","value":" and submit the form, you will receive an exception with "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"Invalid CSRF Token"}]},{"type":"text","value":" message."}]},{"type":"element","tag":"div","props":{"className":["embed","video"]},"children":[{"type":"element","tag":"video","props":{"controls":true},"children":[{"type":"element","tag":"source","props":{"src":"https://res.cloudinary.com/adonis-js/video/upload/q_80/v1587649378/adonisjs.com/csrf_ruyzwo.mp4","type":"video/mp4"},"children":[]}]}]},{"type":"element","tag":"h3","props":{"id":"fixing-the-error"},"children":[{"type":"element","tag":"a","props":{"href":"#fixing-the-error","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Fixing the error"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In order to the fix the error, you will have add a hidden input field to your form that contains a unique CSRF token. Open "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"resources/views/posts/create.edge"}]},{"type":"text","value":" file and update the form body as shown in the following code snippet."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-edge","line-numbers"],"dataLine":"2"},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token other\">&lt;form action=\"</span><span class=\"token mustache\"><span class=\"token punctuation\">{{</span> route(<span class=\"token string\"><span class=\"token punctuation\">'</span><span class=\"token other\">PostsController.store</span><span class=\"token punctuation\">'</span></span>) <span class=\"token punctuation\">}}</span></span><span class=\"token other\">\" method=\"post\"></span>\n<span class=\"dimer-highlight-code-line\">  <span class=\"token mustache\"><span class=\"token punctuation\">{{</span> csrfField() <span class=\"token punctuation\">}}</span></span></span>  <span class=\"token other\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Post title<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>title<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Create Post<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span></span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That's all. Now attempt to submit the form again and it will work fine."}]},{"type":"element","tag":"h3","props":{"id":"how-it-works"},"children":[{"type":"element","tag":"a","props":{"href":"#how-it-works","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"How it works?"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"csrfField"}]},{"type":"text","value":" global helper adds a hidden input field with a secure random token."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The token is generated securely on the server side and cannot be guessed."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When the form is submitted, the Shield middleware will make sure that the token is present, otherwise it denies the request with "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"403"}]},{"type":"text","value":" status code."}]}]},{"type":"element","tag":"h2","props":{"id":"configuration"},"children":[{"type":"element","tag":"a","props":{"href":"#configuration","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Configuration"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The config for the CSRF is stored inside the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"config/shield.ts"}]},{"type":"text","value":" file under the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"csrf"}]},{"type":"text","value":" object."}]},{"type":"element","tag":"h3","props":{"id":"enabled"},"children":[{"type":"element","tag":"a","props":{"href":"#enabled","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"enabled"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"enabled"}]},{"type":"text","value":" flag is used to enable or disable CSRF protection for your app."}]},{"type":"element","tag":"h3","props":{"id":"exceptroutes"},"children":[{"type":"element","tag":"a","props":{"href":"#exceptroutes","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"exceptRoutes"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can define an array of routes to ignore when enforcing CSRF protection."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token punctuation\">{</span>\n  exceptRoutes<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'/contact-us'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'user/:id/payment-confirmation'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"methods"},"children":[{"type":"element","tag":"a","props":{"href":"#methods","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"methods"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The HTTP methods that should be protected against the CSRF attacks. You should add all the methods you use for handling form submissions."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token punctuation\">{</span>\n  methods<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PUT'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PATCH'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'DELETE'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]},{"type":"element","tag":"h3","props":{"id":"enablexsrfcookie"},"children":[{"type":"element","tag":"a","props":{"href":"#enablexsrfcookie","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"enableXsrfCookie"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you are application is rendering not forms on the frontend and hence not using the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"XSRF-TOKEN"}]},{"type":"text","value":" cookie, then it is recommended to turn off the cookie feature all together."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token punctuation\">{</span>\n  enableXsrfCookie<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]},{"type":"element","tag":"h2","props":{"id":"csrf-token-for-spa"},"children":[{"type":"element","tag":"a","props":{"href":"#csrf-token-for-spa","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"CSRF token for SPA"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Single page applications render forms on the frontend and hence they do not have access to the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"csrfField"}]},{"type":"text","value":" global. However, during the Ajax calls, you can read the CSRF token from the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"XSRF-TOKEN"}]},{"type":"text","value":" cookie and send it back as "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"X-XSRF-TOKEN"}]},{"type":"text","value":" header."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The cookie technique is already widely supported by frameworks like "},{"type":"element","tag":"a","props":{"href":"https://angular.io/api/common/http/HttpClientXsrfModule"},"children":[{"type":"text","value":"Angular"}]},{"type":"text","value":" and also by axios."}]},{"type":"element","tag":"div","props":{"className":["alert","alert-note"]},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"XSRF-TOKEN"}]},{"type":"text","value":" cookie is only accessible to the frontend, if your backend and the frontend are on the same domain."}]}]},{"type":"element","tag":"h2","props":{"id":"csrf-token-for-restful-api"},"children":[{"type":"element","tag":"a","props":{"href":"#csrf-token-for-restful-api","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"CSRF token for RESTful API"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you are creating RESTful API server, then you don't need CSRF protection, unless you are relying on cookies for user authentication. If you are relying on cookies for authentication, then simply follow the instructions of "},{"type":"element","tag":"a","props":{"href":"#csrf-token-for-spa"},"children":[{"type":"text","value":"CSRF token for SPA"}]},{"type":"text","value":" section."}]},{"type":"element","tag":"div","props":{"className":["alert","alert-tip"]},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CSRF is an attack exists because of the nature of cookies inside the browser. If there are no cookies, then there is no CSRF attack."}]}]}]}
