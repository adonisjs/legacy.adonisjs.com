{"type":"root","children":[{"type":"element","tag":"dimertitle","props":{},"children":[{"type":"text","value":"Using Socket.Io with Adonis 3.0"}]},{"type":"element","tag":"h1","props":{"id":"using-socketio-with-adonis-30"},"children":[{"type":"element","tag":"a","props":{"href":"#using-socketio-with-adonis-30","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Using Socket.Io with Adonis 3.0"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Since inbuilt support for web sockets is missing in AdonisJs, using "},{"type":"element","tag":"a","props":{"href":"http://socket.io/"},"children":[{"type":"text","value":"socket.io"}]},{"type":"text","value":" with AdonisJs is extremely simple."}]},{"type":"element","tag":"div","props":{"className":["toc-container"]},"children":[{"type":"element","tag":"h2","props":{},"children":[{"type":"text","value":"Table of contents"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#setting-up-socketio"},"children":[{"type":"text","value":"Setting Up Socket.Io"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"setting-up-socketio"},"children":[{"type":"element","tag":"a","props":{"href":"#setting-up-socketio","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Setting Up Socket.Io"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Using Existing Http connection is very common when starting a websocket server using socket.io. Letâ€™s start by creating a "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"socket.js"}]},{"type":"text","value":" file inside "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"app/Http"}]},{"type":"text","value":" directory."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"app/Http/socket.js"}]},{"type":"element","tag":"pre","props":{"className":["language-js","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"module<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">server</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">const</span> io <span class=\"token operator\">=</span> <span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'socket.io'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>server<span class=\"token punctuation\">)</span>\n\n  io<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'connection'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">socket</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'connection created >>>'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">}</span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This file exposes a function which accepts the HTTP server instance and using that instance you can create a web socket connection. Now you can approach socket.io the way you want."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Next you need to import this file inside "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"bootstrap/http.js"}]},{"type":"text","value":" file. Just before "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"Server.listen()"}]},{"type":"text","value":" import this file."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"bootstrap/http.js"}]},{"type":"element","tag":"pre","props":{"className":["language-js","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'App/Http/socket'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>Server<span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nServer<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>Env<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'HOST'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> Env<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'PORT'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n"}]}]}]}]}
